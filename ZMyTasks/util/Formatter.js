/*
 * Copyright (C) 2009-2014 SAP SE or an SAP affiliate company. All rights reserved
 */
jQuery.sap.declare("cus.crm.mytasks.util.Formatter");jQuery.sap.require("cus.crm.mytasks.util.Util");jQuery.sap.require("sap.ca.ui.model.format.DateFormat");cus.crm.mytasks.util.Formatter={I18N_MODEL_NAME:"cus.crm.mytasks.i18n",EDM_STRING:"Edm.String",EDM_GUID:"Edm.Guid",getResourceBundle:function(){if(!this.oBundle){var c=cus.crm.mytasks.util.AppConfig.getConfiguration();jQuery.sap.log.warning("Creating ResBundle for formatter on the fly, but it should have been injected beforehand!");if(c.isDebug){console.trace()}var i=sap.ui.getCore().getModel(cus.crm.mytasks.util.Formatter.I18N_MODEL_NAME);cus.crm.mytasks.util.Util.logObjectToConsole("i18n model",i);if(i){this.oBundle=i.getResourceBundle()}else{jQuery.sap.require("jquery.sap.resources");this.oBundle=jQuery.sap.resources({url:"i18n/i18n.properties"})}}return this.oBundle},showPriorityStatus:function(p,c){var h=cus.crm.mytasks.util.PriorityListUtil.getHighestPrio();return((h==p)&&!c)?"Warning":"None"},getPriorityIcon:function(p,c){var h=cus.crm.mytasks.util.PriorityListUtil.getHighestPrio();return((h==p)&&!c)?"sap-icon://warning":""},showDueDateInDays:function(d,c){if((d==null)||c){return""}var b=cus.crm.mytasks.util.Formatter.getResourceBundle();var n=cus.crm.mytasks.util.Formatter.getCurrentDate();var t=cus.crm.mytasks.util.Formatter.parseDate(d);var a=cus.crm.mytasks.util.Formatter.getDiffInDays(n,t);var r;if(0==a){r=b.getText("LIST_DUE_DATE_TODAY")}else if(1==a){r=b.getText("LIST_DUE_DATE_TOMORROW")}else if(-1==a){r=b.getText("LIST_DUE_DATE_YESTERDAY")}else if(a<0){r=b.getText("LIST_DUE_DATE_X_DAYS_AGO",[-a])}else if(a>0){r=b.getText("LIST_DUE_DATE_IN_X_DAYS",[a])}else{r=""}return r},showDueDateStatus:function(d,c){var s;if((d==null)||c){s="Success"}else{var n=cus.crm.mytasks.util.Formatter.getCurrentDate();var t=cus.crm.mytasks.util.Formatter.parseDate(d);var a=cus.crm.mytasks.util.Formatter.getDiffInDays(n,t);s=a<0?"Warning":"None"}return s},getCurrentDate:function(){var c=new Date();return c},showTaskTitle:function(d,i){var t;if(!i||(""===i)){var b=cus.crm.mytasks.util.Formatter.getResourceBundle();t=b.getText("NEW_TASK_PAGE_TITLE")}else{t=d}return t},getDateEndOfTheWeek:function(){var t=cus.crm.mytasks.util.Formatter.getCurrentDate();var d=(7-t.getDay())%7;var e=new Date(t);e.setDate(t.getDate()+d);return e},parseDate:function(d){if(d==null){return null}if(d instanceof Date){return d}else{var y=d.substring(0,4);var m=d.substring(4,6);var a=d.substring(6,8);var D=new Date(y,m,a);return D}},getPrivacyIcon:function(p){var i="";return i},getDiffInDays:function(d,D){if(!d||!D){return undefined}var o=new Date(d.getTime());var a=new Date(D.getTime());cus.crm.mytasks.util.Formatter.eraseTime(o);cus.crm.mytasks.util.Formatter.eraseTime(a);var b=Math.round((a.getTime()-o.getTime())/(1000*60*60*24));return b},eraseTime:function(d){d.setHours(0);d.setMinutes(0);d.setSeconds(0);d.setMilliseconds(0)},listType:function(c){return c?sap.m.ListType.Inactive:sap.m.ListType.Navigation},formatDate:function(d){var D="";if(d){if(typeof d==="string"){if(d.substring(0,6)==="/Date("){d=d.replace("/Date(","").replace(")/","");d=parseInt(d);d=new Date(d)}else{d=new Date(d)}}if(typeof d==="object"){var a=cus.crm.mytasks.util.Formatter.getDateFormatter();D=a.format(d)}}return D},parseLongDate:function(d){var a=cus.crm.mytasks.util.Formatter.getDateFormatter();var D;try{D=a.parse(d)}catch(e){D=null}return D},getDateFormatter:function(d){var a=sap.ca.ui.model.format.DateFormat.getDateInstance({style:"long"});return a},logoUrlFormatter:function(p){return p&&p.__metadata&&p.__metadata.media_src?p.__metadata.media_src:"sap-icon://factory"},photoUrlFormatter:function(p){return p&&p.__metadata&&p.__metadata.media_src?p.__metadata.media_src:"sap-icon://person-placeholder"},showTitleInMainList:function(d,c){return c?"\u2714 "+d:d},getContactF4Description:function(a,f){var d=cus.crm.mytasks.util.Formatter.combine2AttributesIntoOneString(a,f,"DETAILS_VALUE_HELP_CON_DESCR");return d},getAccountF4Descriptionold:function(c,a){var d=cus.crm.mytasks.util.Formatter.combine2AttributesIntoOneString(c,a,"DETAILS_VALUE_HELP_ACC_DESCR");return d},getAccountF4Description:function(c,a,b){var C=cus.crm.mytasks.util.Formatter.combine2AttributesIntoOneString(c,a,"DETAILS_VALUE_HELP_ACC_DESCR");return C&&C!=""?b&&b!=""?b+" / "+C:C:b&&b!=""?b:""},getAccountF4Title:function(f){return f?f:" "},combine2AttributesIntoOneString:function(a,b,i){var B=cus.crm.mytasks.util.Formatter.getResourceBundle();var c=a&&a.length>0;var d=b&&b.length>0;return c&&d?B.getText(i,[a,b]):c?a:d?b:""},formatBusinessPartner:function(n,i){return n?n:i},showCurrentPriority:function(p){var c=cus.crm.mytasks.util.Util,P=c.getCustomizingModel().getProperty("/priolist");if(!Array.isArray(P))return"";else{var t="";for(var i=0,j=P.length;i<j;i++)if(P[i]["Priority"]===p){t=P[i]["TxtLong"];break}return t}},showPrivacyFlag:function(i){return i?"sap-icon://private":""},formatOverviewField:function(i,p,P){var c=cus.crm.mytasks.util.Formatter,d=c.getDateFormatter(),t="",r=c.getResourceBundle();switch(i){case r.getText("S4_TASK_DUEDATE"):t=jQuery.type(p)==="date"?r.getText("S4_TASK_DUEDATE",[d.format(p)]):"";break;default:t=p&&p!==""?jQuery.sap.formatMessage(i,[p]):P&&P!==""?jQuery.sap.formatMessage(i,[P]):"";break}return t},formatAttachmentURL:function(v){var u=jQuery.sap.getUriParameters(),s=u.get("sap-server"),S=u.get("sap-host"),a=u.get("sap-host-http"),b=u.get("sap-client"),c=location.protocol.replace(':','');var r=URI([location.protocol,location.hostname].join("//")+(location.port?':'+location.port:'')+cus.crm.mytasks.util.Formatter.getRelativePathFromURL(v));if(c!==r.protocol())r.protocol(c);if(s)r.addSearch('sap-server',s);if(S)r.addSearch('sap-host',S);if(a)r.addSearch('sap-host-http',a);return r.toString()},getRelativePathFromURL:function(a){var u=document.createElement('a');u.href=a;if(u.pathname.substring(0,1)=="/")return u.pathname;else return"/"+u.pathname},formatMimeType:function(v){switch(v){case'application/vnd.openxmlformats-officedocument.presentationml.presentation':return'pptx';case'application/vnd.ms-powerpoint':return'ppt';case'application/vnd.openxmlformats-officedocument.presentationml.template':return'potx';case'application/msword':return'doc';case'application/vnd.openxmlformats-officedocument.wordprocessingml.document':return'docx';case'application/vnd.openxmlformats-officedocument.wordprocessingml.template':return'dotx';case'text/csv':return'csv';case'application/vnd.ms-excel':return'xls';case'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet':return'xlsx';case'application/vnd.openxmlformats-officedocument.spreadsheetml.template':return'xltx';case'application/pdf':return'pdf';case'application/xhtml+xml':return'xhtml';case'application/zip':return'zip';case'application/gzip':return'gzip';case'video/avi':return'avi';case'video/mpeg':return'mpeg';case'video/mp4':return'mp4';case'text/html':return'html';case'text/plain':return'txt';case'text/xml':return'xml';case'image/gif':return'gif';case'image/jpeg':return'jpg'||'jpeg';case'image/pjpeg':return'pjpeg';case'image/png':return'png';case'image/bmp':return'bmp';case'image/tiff':return'tif'||'tiff';case'audio/mpeg3':return'mp3';case'audio/x-ms-wmv':return'wmv';case'application/octet-stream':default:return''}},};
